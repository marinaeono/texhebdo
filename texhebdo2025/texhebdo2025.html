<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Magazine TEXHEBDO 2025 par Mélody</title>

<style>
/* --- FOND MODERNE --- */
body {
  margin: 0;
  background: linear-gradient(135deg, #DFF4FF, #F7FBFF);
  font-family: Arial, Helvetica, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 40px 20px;
  min-height: 100vh;
}

/* --- HEADER --- */
.header-mini {
  text-align: center;
  margin-bottom: 20px;
}

.header-mini h1 {
  font-family: "League Gothic", sans-serif;
  font-size: 60px;
  color: #2A4E5C;
  margin: 0;
}

.header-mini p {
  font-size: 18px;
  color: #4A6A78;
  margin-top: 5px;
}

/* --- BOUTON RETOUR --- */
.retour-accueil-icon {
  position: fixed;
  top: 20px;
  left: 20px;
  background: #4FA3C4;
  color: white !important;
  padding: 12px 20px;
  border-radius: 10px;
  text-decoration: none !important;
  font-weight: bold;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  z-index: 9999;
  transition: 0.2s;
}

.retour-accueil-icon:hover {
  transform: scale(1.05);
  background: #6BC6DD;
}

/* --- LIVRE 3D --- */
.book {
  width: 1200px;
  height: 820px;
  position: relative;
  perspective: 2000px;
  margin-top: 20px;
}

.spread {
  position: absolute;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
}

.page {
  width: 540px;
  height: 760px;
  background-size: cover;
  background-position: center;
  cursor: pointer;
  border-radius: 6px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.25);
}

/* PAGE FANTÔME */
.ghostPage {
  position: absolute;
  width: 540px;
  height: 760px;
  left: 840px;
  top: 25px;
  transform-origin: left;
  opacity: 0;
  pointer-events: none;
  background-size: cover;
  background-position: center;
  display: none; /* Correction */
}

.ghostPage .shadow {
  position: absolute;
  width: 100%;
  height: 100%;
  background: linear-gradient(to left, rgba(0,0,0,0.25), transparent);
  opacity: 0;
}

/* --- FLÈCHES DE NAVIGATION --- */
.nav-arrows {
  position: fixed;
  top: 50%;
  left: 0;
  right: 0;
  display: flex;
  justify-content: space-between;
  padding: 0 40px;
  pointer-events: none;
  z-index: 9999;
}

.arrow {
  font-size: 60px;
  color: #2A4E5C;
  cursor: pointer;
  user-select: none;
  pointer-events: auto;
  transition: 0.2s;
}

.arrow:hover {
  transform: scale(1.2);
  color: #4FA3C4;
}

/* --- BOUTON PLEIN ÉCRAN --- */
.fullscreen-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  background: #4FA3C4;
  color: white;
  border: none;
  padding: 12px 20px;
  border-radius: 10px;
  font-size: 16px;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  z-index: 9999;
  transition: 0.2s;
}

.fullscreen-btn:hover {
  transform: scale(1.05);
  background: #6BC6DD;
}

/* MOBILE */
@media (max-width: 900px) {
  .book { width: 100%; height: auto; }
  .page, .ghostPage {
    width: 42vw !important;
    aspect-ratio: 350 / 500;
  }
  .header-mini h1 { font-size: 40px; }
}
</style>
</head>
<body>

<a href="../index.html" class="retour-accueil-icon">Retour accueil</a>
<button id="fullscreenBtn" class="fullscreen-btn">Plein écran</button>

<div class="header-mini">
  <h1>TEXHEBDO 2025</h1>
  <p>Par Mélody</p>
</div>

<div class="book">
  <div class="spread" id="spread">
    <div class="page left" id="leftPage"></div>
    <div class="page right" id="rightPage"></div>
  </div>

  <div class="ghostPage" id="ghostPage">
    <div class="shadow"></div>
  </div>

  <div class="buffer" id="buffer"></div>
</div>

<!-- FLÈCHES -->
<div class="nav-arrows">
  <div id="arrowLeft" class="arrow">◀</div>
  <div id="arrowRight" class="arrow">▶</div>
</div>

<script>
/* --- COUVERTURE --- */
const cover = "pages/2025couverture.jpg";

/* --- LISTE DES PAGES --- */
const pages = [
  "pages/page1.jpg",
  "pages/page2.jpg",
  "pages/page3.jpg",
  "pages/page4.jpg",
  "pages/page5.jpg",
  "pages/page6.jpg",
  "pages/page7.jpg",
  "pages/page8.jpg",
  "pages/page9.jpg",
  "pages/page10.png"
];

/* --- CODE DU LIVRE --- */
const spreads = [];
for (let i = 0; i < pages.length; i += 2) {
  if (pages[i + 1]) spreads.push([pages[i], pages[i + 1]]);
}

[cover, ...pages].forEach(src => { const img = new Image(); img.src = src; });

let currentSpread = 0;

const spread = document.getElementById("spread");
const leftPage = document.getElementById("leftPage");
const rightPage = document.getElementById("rightPage");
const ghost = document.getElementById("ghostPage");
const ghostShadow = ghost.querySelector(".shadow");
const buffer = document.getElementById("buffer");

/* Correction */
ghost.style.display = "none";

/* AFFICHAGE DES PAGES */
function showSpread(index) {
  if (index === 0) {
    leftPage.style.backgroundImage = "none";
    rightPage.style.backgroundImage = `url(${cover})`;
    return;
  }
  const spreadData = spreads[index - 1];
  leftPage.style.backgroundImage = `url(${spreadData[0]})`;
  rightPage.style.backgroundImage = `url(${spreadData[1]})`;
}

showSpread(0);

/* PRÉCHARGEMENT */
function prerenderSpread(index) {
  if (index >= 1 && index <= spreads.length) {
    const nextSpread = spreads[index - 1];
    buffer.style.backgroundImage = `url(${nextSpread[1]})`;
  }
}

prerenderSpread(1);

/* AVANCER */
rightPage.addEventListener("click", () => {

  if (currentSpread === 0) {
    ghost.style.display = "block";
    ghost.style.backgroundImage = `url(${cover})`;
    ghost.classList.add("coverOpening");

    setTimeout(() => {
      ghost.classList.remove("coverOpening");
      ghost.style.display = "none";
      currentSpread = 1;
      showSpread(1);
      prerenderSpread(2);
    }, 500);
    return;
  }

  if (currentSpread === spreads.length) {
    ghost.style.display = "block";
    ghost.style.backgroundImage = rightPage.style.backgroundImage;
    ghost.classList.add("coverClosing");

    setTimeout(() => {
      ghost.classList.remove("coverClosing");
      ghost.style.display = "none";
      currentSpread = 0;
      showSpread(0);
    }, 500);
    return;
  }

  ghost.style.display = "block";
  ghost.style.backgroundImage = rightPage.style.backgroundImage;
  ghost.classList.add("turningGhost");
  ghostShadow.style.opacity = 0.4;

  setTimeout(() => {
    currentSpread++;
    showSpread(currentSpread);
    prerenderSpread(currentSpread + 1);
  }, 400);

  setTimeout(() => {
    ghost.classList.remove("turningGhost");
    ghostShadow.style.opacity = 0;
    ghost.style.display = "none";
  }, 800);
});

/* RECULER */
leftPage.addEventListener("click", () => {

  if (currentSpread === 1) {
    ghost.style.display = "block";
    ghost.style.backgroundImage = `url(${cover})`;
    ghost.classList.add("coverClosing");

    setTimeout(() => {
      ghost.classList.remove("coverClosing");
      ghost.style.display = "none";
      currentSpread = 0;
      showSpread(0);
    }, 500);
    return;
  }

  if (currentSpread === 0) return;

  ghost.style.display = "block";
  ghost.style.backgroundImage = leftPage.style.backgroundImage;
  ghost.classList.add("turningGhostReverse");
  ghostShadow.style.opacity = 0.4;

  setTimeout(() => {
    currentSpread--;
    showSpread(currentSpread);
    prerenderSpread(currentSpread - 1);
  }, 400);

  setTimeout(() => {
    ghost.classList.remove("turningGhostReverse");
    ghostShadow.style.opacity = 0;
    ghost.style.display = "none";
  }, 800);
});

/* FLÈCHES */
document.getElementById("arrowRight").addEventListener("click", () => {
  rightPage.click();
});

document.getElementById("arrowLeft").addEventListener("click", () => {
  leftPage.click();
});

/* MODE PLEIN ÉCRAN */
document.getElementById("fullscreenBtn").addEventListener("click", () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
    fullscreenBtn.textContent = "Quitter plein écran";
  } else {
    document.exitFullscreen();
    fullscreenBtn.textContent = "Plein écran";
  }
});
</script>

</body>
</html>
